{"ts":1363868017640,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1363876841506,"patch":[[{"diffs":[[1,"var express = require('express'),\n    app = module.exports = express.createServer(),\n    ejsMIddleware = require('ejs-middleware'),\n    db = require('./db'),\n    invitation = require('../models/invitation'),\n    vote = require('../models/vote');\n    \napp.use(express.bodyParser());\n\napp.get('/invitations/:id', function(req, res) {\n    var result = db.load(req.params.id);\n    result ? res.send(result)\n           : res.send(404)\n    });\n\napp.post('/invitations', function(req, res) {\n    var newInvitation = new invitation(req.body);\n    db.save(newInvitation);\n    \n    res.header('Location', 'http://' + req.headers.host + app.set('basepath') + req.url + '/' + newInvitation.id);\n    res.send({id: newInvitation.id}, 201);\n});\n\napp.post('/invitations/:id/votes', function(req, res) {\n    var invitation = db.load(req.params.id);\n    if(invitation) {\n        invitation.votes.push(new vote(req.body));\n        db.save(invitation);\n        res.send(200);\n        \n        //app.emit('invitationUpdate', invitation);\n    } else {\n        res.send(404);\n    }\n});\n\n// Add test data for demo\ndb.save(new invitation(\n    { title: 'Node.js user group seminar - June 2012', choices: [{displayText: 'Tue 12th'}, {displayText: 'Wed 13th'}, {displayText: 'Thu 14th'}, {displayText: 'Fri 15th'}]},\n    'test' //ID\n));"]],"start1":0,"start2":0,"length1":0,"length2":1308}]],"length":1308,"saved":false}
{"ts":1363877076306,"patch":[[{"diffs":[[0,"ion = require('."],[-1,"."],[0,"/models/invitati"]],"start1":169,"start2":169,"length1":33,"length2":32},{"diffs":[[0,"quire('."],[-1,"."],[0,"/models/"]],"start1":220,"start2":220,"length1":17,"length2":16}]],"length":1306,"saved":false}
