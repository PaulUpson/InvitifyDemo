{"ts":1363868017640,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1363876841506,"patch":[[{"diffs":[[1,"var express = require('express'),\n    app = module.exports = express.createServer(),\n    ejsMIddleware = require('ejs-middleware'),\n    db = require('./db'),\n    invitation = require('../models/invitation'),\n    vote = require('../models/vote');\n    \napp.use(express.bodyParser());\n\napp.get('/invitations/:id', function(req, res) {\n    var result = db.load(req.params.id);\n    result ? res.send(result)\n           : res.send(404)\n    });\n\napp.post('/invitations', function(req, res) {\n    var newInvitation = new invitation(req.body);\n    db.save(newInvitation);\n    \n    res.header('Location', 'http://' + req.headers.host + app.set('basepath') + req.url + '/' + newInvitation.id);\n    res.send({id: newInvitation.id}, 201);\n});\n\napp.post('/invitations/:id/votes', function(req, res) {\n    var invitation = db.load(req.params.id);\n    if(invitation) {\n        invitation.votes.push(new vote(req.body));\n        db.save(invitation);\n        res.send(200);\n        \n        //app.emit('invitationUpdate', invitation);\n    } else {\n        res.send(404);\n    }\n});\n\n// Add test data for demo\ndb.save(new invitation(\n    { title: 'Node.js user group seminar - June 2012', choices: [{displayText: 'Tue 12th'}, {displayText: 'Wed 13th'}, {displayText: 'Thu 14th'}, {displayText: 'Fri 15th'}]},\n    'test' //ID\n));"]],"start1":0,"start2":0,"length1":0,"length2":1308}]],"length":1308,"saved":false}
{"ts":1363877076306,"patch":[[{"diffs":[[0,"ion = require('."],[-1,"."],[0,"/models/invitati"]],"start1":169,"start2":169,"length1":33,"length2":32},{"diffs":[[0,"quire('."],[-1,"."],[0,"/models/"]],"start1":220,"start2":220,"length1":17,"length2":16}]],"length":1306,"saved":false}
{"contributors":[],"silentsave":false,"ts":1364303259442,"patch":[[{"diffs":[[0,"r(),"],[-1,"\n"],[0,"    "],[-1,"ejsMIddleware = require('ejs-middleware'),"],[0,"\n   "]],"start1":80,"start2":80,"length1":55,"length2":12}]],"length":1263,"saved":false}
{"contributors":[],"silentsave":false,"ts":1364303438910,"patch":[[{"diffs":[[0,"ress"],[-1,".createServer"],[0,"(), "]],"start1":64,"start2":64,"length1":21,"length2":8}]],"length":1250,"saved":false}
{"ts":1364303464837,"patch":[[{"diffs":[[0,"xpress')"],[-1,","],[0,"\n  "],[-1," "],[1,","],[0," app = m"]],"start1":24,"start2":24,"length1":21,"length2":20},{"diffs":[[0,"ss()"],[-1,",    "],[0,"\n  "],[-1," "],[1,","],[0," db "]],"start1":65,"start2":65,"length1":17,"length2":12},{"diffs":[[0,"('./db')"],[-1,","],[0,"\n  "],[-1," "],[1,","],[0," invitat"]],"start1":86,"start2":86,"length1":21,"length2":20},{"diffs":[[0,"tation')"],[-1,","],[0,"\n  "],[-1," "],[1,","],[0," vote = "]],"start1":134,"start2":134,"length1":21,"length2":20}]],"length":1242,"saved":false}
{"contributors":[],"silentsave":false,"ts":1364304838922,"patch":[[{"diffs":[[0," express"],[1,".createServer"],[0,"()\n  , d"]],"start1":59,"start2":59,"length1":16,"length2":29}]],"length":1255,"saved":false}
